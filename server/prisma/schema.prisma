generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id           Int          @id @default(autoincrement())
  email        String       @unique
  name         String?
  passwordHash String
  role         String       @default("customer") // "admin", "customer"
  orders       Order[]
  commissions  Commission[]
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
}

model Product {
  id               Int            @id @default(autoincrement())
  title            String
  description      String
  price            Decimal
  category         String
  dimensions       String?
  materials        String?
  stock            Int            @default(0)
  isLimitedEdition Boolean        @default(false)
  editionSize      Int?
  soldCount        Int            @default(0)
  images           ProductImage[]
  orderItems       OrderItem[]
  createdAt        DateTime       @default(now())
  updatedAt        DateTime       @updatedAt
}

model ProductImage {
  id        Int     @id @default(autoincrement())
  url       String
  productId Int
  product   Product @relation(fields: [productId], references: [id])
}

model Order {
  id              Int         @id @default(autoincrement())
  userId          Int?
  user            User?       @relation(fields: [userId], references: [id])
  totalAmount     Decimal
  paymentStatus   String      @default("pending")
  shippingAddress String?
  items           OrderItem[]
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
}

model OrderItem {
  id        Int     @id @default(autoincrement())
  orderId   Int
  order     Order   @relation(fields: [orderId], references: [id])
  productId Int
  product   Product @relation(fields: [productId], references: [id])
  quantity  Int
  price     Decimal
}

model Commission {
  id          Int       @id @default(autoincrement())
  clientName  String
  email       String
  phone       String?
  type        String?
  budgetRange String?
  deadline    DateTime?
  description String
  status      String    @default("pending")
  depositPaid Boolean   @default(false)
  finalPaid   Boolean   @default(false)
  userId      Int?
  user        User?     @relation(fields: [userId], references: [id])
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model NewsletterSubscriber {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  createdAt DateTime @default(now())
}
